<!-- Session profile -->
        <div ng-if="isLoggedIn" class="profile-section">
            <h2>Profil de {{ user.nom }} {{ user.prenom }}</h2>
            <img ng-src="{{ user.photo || 'default-avatar.png' }}" alt="Photo de profil">
            <p><strong>Pseudo:</strong> {{ user.pseudo }}</p>
            <p><strong>Âge:</strong> {{ user.age }} ans</p>
            <p><strong>Genre:</strong> {{ user.genre }}</p>
            <p><strong>Type:</strong> {{ user.type }}</p>
            <p><strong>Email:</strong> {{ user.mail }}</p>
            <p><strong>Rang:</strong> {{ user.rang }}</p>
            <p><strong>Points:</strong> {{ user.nb_point }}</p>
            <p><strong>Compte validé:</strong> {{ user.validite ? 'Oui' : 'Non' }}</p>

            <button ng-click="openModifProfile()">Modifier profil</button>
        </div>

        <div ng-if="selectedRang === 'admin'">
            <table>
                <thead>
                    <tr>
                        <th>Pseudo</th>
                        <th>Nom</th>
                        <th>Prenom</th>
                        <th>Rang</th>
                        <th>Validite</th>
                        <th>Mail</th>
                        <th>Visualiser</th>
                    </tr>
                </thead>
                    <tr ng-repeat="user in userslist">
                        <td><strong>{{ user.pseudo }}</strong></td>
                        <td><strong>{{ user.nom }}</strong></td>
                        <td><strong>{{ user.prenom }}</strong></td>
                        <td><strong>{{ user.rang }}</strong></td>
                        <td><strong>{{ user.validite }}</strong></td>
                        <td><strong>{{ user.mail }}</strong></td>
                    </tr>
                <tbody>

                </tbody>
            </table>
        </div>



<div class="modal-overlay" ng-show="showModifUser" ng-click="closeModifUser()">
    <div class="modal-content">
        <h2>Modifier votre profil</h2>
        <form ng-submit="updateProfile()">
            <label>Pseudo:</label>
            <input type="text" ng-model="user.pseudo" disabled /><br>
                
            <label>Nom:</label>
            <input type="text" ng-model="user.nom" required /><br>
            
            <label>Prénom:</label>
            <input type="text" ng-model="user.prenom" required /><br>
            
            <label>Âge:</label>
            <input type="number" ng-model="user.age" required /><br>
            
            <label>Genre:</label>
            <select ng-model="user.genre">
                <option value="Homme">Homme</option>
                <option value="Femme">Femme</option>
                <option value="Autre">Autre</option>
            </select><br>
                
            <label>Type:</label>
            <input type="text" ng-model="user.type" /><br>
                
            <label>Email:</label>
            <input type="email" ng-model="user.mail" required /><br>
                
            <label>Mot de passe:</label>
            <input type="password" ng-model="user.mdp" required /><br>
            
            <label>Photo de profil:</label>
            <input type="text" ng-model="user.photo" placeholder="Lien vers l'image" /><br>
            
            <button type="submit">Mettre à jour</button>
        </form>
        <p>{{ message }}</p>
    </div>

</div>



    function affichageProfile(){
        var urlParams = new URLSearchParams(window.location.search);
        var pseudo = urlParams.get('pseudo');

        if ($scope.isLoggedIn) {
            // faire la recup de l'utilisateur
            $http.post('api/getuser.php', {pseudo : 'admin'}).then(function(response){
                if (response.data.success) {
                    $scope.user = response.data.data;
                } else {
                    alert(response.data.message);
                    $window.location.href = 'index.html';
                }
            }, function(error) {
                console.error("Erreur lors du chargement du profil :", error);
                alert("Erreur lors de la récupération des informations du profile");
                $window.location.href = 'index.html';
            });
        }
    }

    $scope.loadProfile = function() {
        affichageProfile();
    };

    $scope.updateProfile = function() {
        // faire la recup de l'user
        $http.post('api/modifyuser.php', $scope.user).then(function(response) {
            $scope.message = "Profil mis à jour avec succès";
        }, function(error) {
            console.error("Erreur lors de la mise à jour du profil", error);
            $scope.message = "Erreur lors de la mise à jour du profil";
        });

        $scope.showModifUser = false; //ferme la page lors de la mis a jour
    };

    $scope.openModifProfile = function(){
        $scope.showModifUser = true;
    }

    $http.get('api/users.php')
        .then(function(response) {
            $scope.userslist = response.data.users;
        })
        .catch(function(error) {
            
            console.error('Erreur lors de la recuperation des users:', error);
            $scope.loading = false;
        });


affichageProfile(); // in checkAuth function

$scope.userslist = [];
$scope.showModifUser = false;